{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Trinj/OneDrive/Desktop/fisc-financial-backend/src/utils/finance.ts"],"sourcesContent":["import { Bucket } from '@/hooks/useHorizon';\r\n\r\nexport interface ProjectedBucket extends Bucket {\r\n    projected_balance: number;\r\n}\r\n\r\n/**\r\n * Calculates projected bucket balances based on income input.\r\n * Enforces a \"Hard Cap\" rule where current_balance + potential_add cannot exceed target_amount.\r\n * \r\n * @param income The income amount to distribute.\r\n * @param buckets The list of buckets to distribute income to.\r\n * @returns A new array of buckets with projected_balance.\r\n */\r\nexport const calculateProjections = (income: number, buckets: Bucket[]): ProjectedBucket[] => {\r\n    // If no income or negative, return buckets with projected = current\r\n    if (!income || income <= 0) {\r\n        return buckets.map(b => ({\r\n            ...b,\r\n            projected_balance: b.current_balance || 0\r\n        }));\r\n    }\r\n\r\n    // Calculate total target amount to determine ratios\r\n    const totalTarget = buckets.reduce((acc, b) => acc + b.target_amount, 0);\r\n\r\n    return buckets.map(bucket => {\r\n        // Calculate distribution ratio based on target amount\r\n        // If totalTarget is 0, ratio is 0 to avoid division by zero\r\n        const ratio = totalTarget > 0 ? bucket.target_amount / totalTarget : 0;\r\n\r\n        // Calculate potential addition\r\n        const potentialAdd = income * ratio;\r\n\r\n        // Current balance (default to 0 if undefined)\r\n        const currentBalance = bucket.current_balance || 0;\r\n\r\n        // Calculate raw new balance\r\n        const rawNewBalance = currentBalance + potentialAdd;\r\n\r\n        // HARD CAP RULE: Ensure projected balance does not exceed target amount\r\n        // However, if current balance is ALREADY over target, we shouldn't decrease it, \r\n        // effectively we just don't add more? \r\n        // The rule says \"current_balance + potential_add does NOT exceed target_amount\".\r\n        // If current_balance >= target, then we add 0?\r\n        // Let's assume clamping to target_amount is the goal.\r\n        // Math.min(rawNewBalance, bucket.target_amount) handles the cap.\r\n        // But we need to handle the case where current_balance > target_amount (overfunded).\r\n        // If overfunded, we probably just keep it as is.\r\n\r\n        const projectedBalance = Math.min(rawNewBalance, bucket.target_amount);\r\n\r\n        // Edge case: If we were already over target, Math.min would clamp us down to target.\r\n        // We probably shouldn't reduce balance.\r\n        // So projected should be max(current, min(raw, target))?\r\n        // Actually, if we are strictly ADDING, we just clamp the ADDITION.\r\n        // Let's stick to the prompt's logic: \"Clamp the addition so it exactly hits the target.\"\r\n\r\n        // If current is 100, target is 100. Add 10. Raw 110. Cap at 100.\r\n        // If current is 110 (overfunded), target is 100. Add 10. Raw 120. Cap at 100? No, that reduces funds.\r\n        // The logical behavior for \"Hard Cap on Addition\" is:\r\n        // Max allow to add = target - current.\r\n        // If max allow < 0, add 0.\r\n\r\n        const spaceRemaining = Math.max(0, bucket.target_amount - currentBalance);\r\n        const actualAdd = Math.min(potentialAdd, spaceRemaining);\r\n\r\n        return {\r\n            ...bucket,\r\n            projected_balance: currentBalance + actualAdd\r\n        };\r\n    });\r\n};\r\n"],"names":[],"mappings":";;;;AAcO,MAAM,uBAAuB,CAAC,QAAgB;IACjD,oEAAoE;IACpE,IAAI,CAAC,UAAU,UAAU,GAAG;QACxB,OAAO,QAAQ,GAAG,CAAC,CAAA,IAAK,CAAC;gBACrB,GAAG,CAAC;gBACJ,mBAAmB,EAAE,eAAe,IAAI;YAC5C,CAAC;IACL;IAEA,oDAAoD;IACpD,MAAM,cAAc,QAAQ,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,aAAa,EAAE;IAEtE,OAAO,QAAQ,GAAG,CAAC,CAAA;QACf,sDAAsD;QACtD,4DAA4D;QAC5D,MAAM,QAAQ,cAAc,IAAI,OAAO,aAAa,GAAG,cAAc;QAErE,+BAA+B;QAC/B,MAAM,eAAe,SAAS;QAE9B,8CAA8C;QAC9C,MAAM,iBAAiB,OAAO,eAAe,IAAI;QAEjD,4BAA4B;QAC5B,MAAM,gBAAgB,iBAAiB;QAEvC,wEAAwE;QACxE,iFAAiF;QACjF,uCAAuC;QACvC,iFAAiF;QACjF,+CAA+C;QAC/C,sDAAsD;QACtD,iEAAiE;QACjE,qFAAqF;QACrF,iDAAiD;QAEjD,MAAM,mBAAmB,KAAK,GAAG,CAAC,eAAe,OAAO,aAAa;QAErE,qFAAqF;QACrF,wCAAwC;QACxC,yDAAyD;QACzD,mEAAmE;QACnE,yFAAyF;QAEzF,iEAAiE;QACjE,sGAAsG;QACtG,sDAAsD;QACtD,uCAAuC;QACvC,2BAA2B;QAE3B,MAAM,iBAAiB,KAAK,GAAG,CAAC,GAAG,OAAO,aAAa,GAAG;QAC1D,MAAM,YAAY,KAAK,GAAG,CAAC,cAAc;QAEzC,OAAO;YACH,GAAG,MAAM;YACT,mBAAmB,iBAAiB;QACxC;IACJ;AACJ"}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Trinj/OneDrive/Desktop/fisc-financial-backend/src/app/horizon/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { calculateProjections } from '@/utils/finance';\r\n\r\nexport default function HorizonPage() {\r\n    const { currentWeek, buckets, isLoading, error } = useHorizon();\r\n    const [incomeInput, setIncomeInput] = useState('');\r\n\r\n    // Calculate projected buckets based on input\r\n    const projectedBuckets = useMemo(() => {\r\n        // Parse input amount (default to 0 if invalid)\r\n        const income = parseFloat(incomeInput) || 0;\r\n\r\n        return calculateProjections(income, buckets);\r\n    }, [buckets, incomeInput]);\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"min-h-screen flex items-center justify-center bg-[#F9F9F7] font-sans text-[#2D2D2D]\">\r\n                <div className=\"text-center animate-pulse\">\r\n                    <h2 className=\"text-xl font-medium text-text-charcoal mb-2\">We're updating your balances...</h2>\r\n                    <p className=\"text-gray-400 text-sm\">Just a moment while we crunch the numbers.</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (error) {\r\n        return (\r\n            <div className=\"min-h-screen flex items-center justify-center bg-[#F9F9F7] font-sans text-[#2D2D2D]\">\r\n                <div className=\"text-center\">\r\n                    <h2 className=\"text-xl font-medium text-red-600 mb-2\">That didn't quite work, let's try again.</h2>\r\n                    <p className=\"text-gray-400 text-sm\">{error}</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <main className=\"min-h-screen bg-[#F9F9F7] p-8 md:p-10 font-sans text-[#2D2D2D]\">\r\n            <div className=\"max-w-7xl mx-auto space-y-8\">\r\n                <header className=\"mb-10\">\r\n                    <h1 className=\"text-3xl md:text-4xl font-bold text-text-charcoal tracking-tight\">\r\n                        Financial Horizon\r\n                    </h1>\r\n                    <p className=\"text-gray-500 mt-2 text-lg\">\r\n                        Your weekly financial health at a glance.\r\n                    </p>\r\n                </header>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\r\n                    {/* Card 1: Income Input */}\r\n                    <div className=\"lg:col-span-1\">\r\n                        <IncomeInput\r\n                            amount={incomeInput}\r\n                            onAmountChange={setIncomeInput}\r\n                        />\r\n                    </div>\r\n\r\n                    {/* Card 2: Weekly Calendar - Show current week + maybe placeholders if needed, but for now just pass current week in array if it exists */}\r\n                    <div className=\"lg:col-span-1\">\r\n                        <WeeklyCalendar payPeriods={currentWeek ? [currentWeek] : []} />\r\n                    </div>\r\n\r\n                    {/* Card 3: Bucket Allocations - Pass PROJECTED buckets */}\r\n                    <div className=\"lg:col-span-1\">\r\n                        <BucketAllocations buckets={projectedBuckets} />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </main>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIe,SAAS;IACpB,MAAM,EAAE,WAAW,EAAE,OAAO,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG;IACnD,MAAM,CAAC,aAAa,eAAe,GAAG,SAAS;IAE/C,6CAA6C;IAC7C,MAAM,mBAAmB,QAAQ;QAC7B,+CAA+C;QAC/C,MAAM,SAAS,WAAW,gBAAgB;QAE1C,OAAO,IAAA,+IAAoB,EAAC,QAAQ;IACxC,GAAG;QAAC;QAAS;KAAY;IAEzB,IAAI,WAAW;QACX,qBACI,8OAAC;YAAI,WAAU;sBACX,cAAA,8OAAC;gBAAI,WAAU;;kCACX,8OAAC;wBAAG,WAAU;kCAA8C;;;;;;kCAC5D,8OAAC;wBAAE,WAAU;kCAAwB;;;;;;;;;;;;;;;;;IAIrD;IAEA,IAAI,OAAO;QACP,qBACI,8OAAC;YAAI,WAAU;sBACX,cAAA,8OAAC;gBAAI,WAAU;;kCACX,8OAAC;wBAAG,WAAU;kCAAwC;;;;;;kCACtD,8OAAC;wBAAE,WAAU;kCAAyB;;;;;;;;;;;;;;;;;IAItD;IAEA,qBACI,8OAAC;QAAK,WAAU;kBACZ,cAAA,8OAAC;YAAI,WAAU;;8BACX,8OAAC;oBAAO,WAAU;;sCACd,8OAAC;4BAAG,WAAU;sCAAmE;;;;;;sCAGjF,8OAAC;4BAAE,WAAU;sCAA6B;;;;;;;;;;;;8BAK9C,8OAAC;oBAAI,WAAU;;sCAEX,8OAAC;4BAAI,WAAU;sCACX,cAAA,8OAAC;gCACG,QAAQ;gCACR,gBAAgB;;;;;;;;;;;sCAKxB,8OAAC;4BAAI,WAAU;sCACX,cAAA,8OAAC;gCAAe,YAAY,cAAc;oCAAC;iCAAY,GAAG,EAAE;;;;;;;;;;;sCAIhE,8OAAC;4BAAI,WAAU;sCACX,cAAA,8OAAC;gCAAkB,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMpD"}},
    {"offset": {"line": 255, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Trinj/OneDrive/Desktop/fisc-financial-backend/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":"AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF","ignoreList":[0]}},
    {"offset": {"line": 274, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Trinj/OneDrive/Desktop/fisc-financial-backend/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0]}}]
}